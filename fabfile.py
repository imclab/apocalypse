#!/usr/bin/env python

from collections import defaultdict
import csv
import json
import os
import re
from sets import Set

from bs4 import BeautifulSoup
from fabric.api import *
import requests

INITIAL_BOOKS = Set([u'http://openlibrary.org/api/get?key=/books/OL7347868M', u'http://openlibrary.org/api/get?key=/books/OL807903M', u'http://openlibrary.org/api/get?key=/books/OL8859652M', u'http://openlibrary.org/api/get?key=/books/OL77050M', u'http://openlibrary.org/api/get?key=/books/OL6792731M', u'http://openlibrary.org/api/get?key=/books/OL7586612M', u'http://openlibrary.org/api/get?key=/books/OL24020122M', u'http://openlibrary.org/api/get?key=/books/OL10979647M', u'http://openlibrary.org/api/get?key=/books/OL8962552M', u'http://openlibrary.org/api/get?key=/books/OL788216M', u'http://openlibrary.org/api/get?key=/books/OL2769086M', u'http://openlibrary.org/api/get?key=/books/OL1566523M', u'http://openlibrary.org/api/get?key=/books/OL3208026M', u'http://openlibrary.org/api/get?key=/books/OL19159027M', u'http://openlibrary.org/api/get?key=/books/OL8744142M', u'http://openlibrary.org/api/get?key=/books/OL9371874M', u'http://openlibrary.org/api/get?key=/books/OL7647876M', u'http://openlibrary.org/api/get?key=/books/OL6779698M', u'http://openlibrary.org/api/get?key=/books/OL3673532M', u'http://openlibrary.org/api/get?key=/books/OL838725M', u'http://openlibrary.org/api/get?key=/books/OL9624079M', u'http://openlibrary.org/api/get?key=/books/OL24087179M', u'http://openlibrary.org/api/get?key=/books/OL7894518M', u'http://openlibrary.org/api/get?key=/books/OL2841946M', u'http://openlibrary.org/api/get?key=/books/OL4924325M', u'http://openlibrary.org/api/get?key=/books/OL3145241M', u'http://openlibrary.org/api/get?key=/books/OL3949418M', u'http://openlibrary.org/api/get?key=/books/OL9463861M', u'http://openlibrary.org/api/get?key=/books/OL2200410M', u'http://openlibrary.org/api/get?key=/books/OL10316510M', u'http://openlibrary.org/api/get?key=/books/OL5811651M', u'http://openlibrary.org/api/get?key=/books/OL6643860M', u'http://openlibrary.org/api/get?key=/books/OL6094302M', u'http://openlibrary.org/api/get?key=/books/OL809254M', u'http://openlibrary.org/api/get?key=/books/OL8518631M', u'http://openlibrary.org/api/get?key=/books/OL979615M', u'http://openlibrary.org/api/get?key=/books/OL2769393M', u'http://openlibrary.org/api/get?key=/books/OL7962796M', u'http://openlibrary.org/api/get?key=/books/OL2390109M', u'http://openlibrary.org/api/get?key=/books/OL13383556M', u'http://openlibrary.org/api/get?key=/books/OL7984115M', u'http://openlibrary.org/api/get?key=/books/OL7830354M', u'http://openlibrary.org/api/get?key=/books/OL10608720M', u'http://openlibrary.org/api/get?key=/books/OL496156M', u'http://openlibrary.org/api/get?key=/books/OL8432285M', u'http://openlibrary.org/api/get?key=/books/OL4205139M', u'http://openlibrary.org/api/get?key=/books/OL1802277M', u'http://openlibrary.org/api/get?key=/books/OL168163M', u'http://openlibrary.org/api/get?key=/books/OL1100111M', u'http://openlibrary.org/api/get?key=/books/OL7825012M', u'http://openlibrary.org/api/get?key=/books/OL4224583M', u'http://openlibrary.org/api/get?key=/books/OL356398M', u'http://openlibrary.org/api/get?key=/books/OL868557M', u'http://openlibrary.org/api/get?key=/books/OL10411645M', u'http://openlibrary.org/api/get?key=/books/OL1097121M', u'http://openlibrary.org/api/get?key=/books/OL2860465M', u'http://openlibrary.org/api/get?key=/books/OL9799835M', u'http://openlibrary.org/api/get?key=/books/OL11664466M', u'http://openlibrary.org/api/get?key=/books/OL1025106M', u'http://openlibrary.org/api/get?key=/books/OL3480859M', u'http://openlibrary.org/api/get?key=/books/OL9390635M', u'http://openlibrary.org/api/get?key=/books/OL1011317M', u'http://openlibrary.org/api/get?key=/books/OL3567048M', u'http://openlibrary.org/api/get?key=/books/OL11630819M', u'http://openlibrary.org/api/get?key=/books/OL6187204M', u'http://openlibrary.org/api/get?key=/books/OL5806223M', u'http://openlibrary.org/api/get?key=/books/OL804219M', u'http://openlibrary.org/api/get?key=/books/OL2114647M', u'http://openlibrary.org/api/get?key=/books/OL7568162M', u'http://openlibrary.org/api/get?key=/books/OL3581988M', u'http://openlibrary.org/api/get?key=/books/OL981857M', u'http://openlibrary.org/api/get?key=/books/OL572846M', u'http://openlibrary.org/api/get?key=/books/OL5141152M', u'http://openlibrary.org/api/get?key=/books/OL9523261M', u'http://openlibrary.org/api/get?key=/books/OL11813331M', u'http://openlibrary.org/api/get?key=/books/OL3656628M', u'http://openlibrary.org/api/get?key=/books/OL352517M', u'http://openlibrary.org/api/get?key=/books/OL1004006M', u'http://openlibrary.org/api/get?key=/books/OL310523M', u'http://openlibrary.org/api/get?key=/books/OL21162829M', u'http://openlibrary.org/api/get?key=/books/OL10548607M', u'http://openlibrary.org/api/get?key=/books/OL714732M', u'http://openlibrary.org/api/get?key=/books/OL1077121M', u'http://openlibrary.org/api/get?key=/books/OL9570151M', u'http://openlibrary.org/api/get?key=/books/OL8453172M', u'http://openlibrary.org/api/get?key=/books/OL3844493M', u'http://openlibrary.org/api/get?key=/books/OL434998M', u'http://openlibrary.org/api/get?key=/books/OL7921351M', u'http://openlibrary.org/api/get?key=/books/OL9496669M', u'http://openlibrary.org/api/get?key=/books/OL7459802M', u'http://openlibrary.org/api/get?key=/books/OL13825089M', u'http://openlibrary.org/api/get?key=/books/OL1453629M', u'http://openlibrary.org/api/get?key=/books/OL1852818M', u'http://openlibrary.org/api/get?key=/books/OL7660606M', u'http://openlibrary.org/api/get?key=/books/OL6573614M', u'http://openlibrary.org/api/get?key=/books/OL8617182M', u'http://openlibrary.org/api/get?key=/books/OL10713111M', u'http://openlibrary.org/api/get?key=/books/OL1856053M', u'http://openlibrary.org/api/get?key=/books/OL8700733M', u'http://openlibrary.org/api/get?key=/books/OL5068394M', u'http://openlibrary.org/api/get?key=/books/OL20299996M', u'http://openlibrary.org/api/get?key=/books/OL4325376M', u'http://openlibrary.org/api/get?key=/books/OL2729813M', u'http://openlibrary.org/api/get?key=/books/OL6676567M', u'http://openlibrary.org/api/get?key=/books/OL2937069M', u'http://openlibrary.org/api/get?key=/books/OL24084805M', u'http://openlibrary.org/api/get?key=/books/OL888415M', u'http://openlibrary.org/api/get?key=/books/OL7072977M', u'http://openlibrary.org/api/get?key=/books/OL665911M', u'http://openlibrary.org/api/get?key=/books/OL1017643M', u'http://openlibrary.org/api/get?key=/books/OL5545839M', u'http://openlibrary.org/api/get?key=/books/OL5798829M', u'http://openlibrary.org/api/get?key=/books/OL11589024M', u'http://openlibrary.org/api/get?key=/books/OL1230137M', u'http://openlibrary.org/api/get?key=/books/OL7295565M', u'http://openlibrary.org/api/get?key=/books/OL1278309M', u'http://openlibrary.org/api/get?key=/books/OL3948935M', u'http://openlibrary.org/api/get?key=/books/OL7568550M', u'http://openlibrary.org/api/get?key=/books/OL3303185M', u'http://openlibrary.org/api/get?key=/books/OL2757504M', u'http://openlibrary.org/api/get?key=/books/OL7285003M', u'http://openlibrary.org/api/get?key=/books/OL9321322M', u'http://openlibrary.org/api/get?key=/books/OL6324432M', u'http://openlibrary.org/api/get?key=/books/OL14325940M', u'http://openlibrary.org/api/get?key=/books/OL11849661M', u'http://openlibrary.org/api/get?key=/books/OL9466647M', u'http://openlibrary.org/api/get?key=/books/OL394152M', u'http://openlibrary.org/api/get?key=/books/OL9896376M', u'http://openlibrary.org/api/get?key=/books/OL7349465M', u'http://openlibrary.org/api/get?key=/books/OL6660312M', u'http://openlibrary.org/api/get?key=/books/OL181796M', u'http://openlibrary.org/api/get?key=/books/OL23120920M', u'http://openlibrary.org/api/get?key=/books/OL3572239M', u'http://openlibrary.org/api/get?key=/books/OL9070745M', u'http://openlibrary.org/api/get?key=/books/OL822716M', u'http://openlibrary.org/api/get?key=/books/OL70210M', u'http://openlibrary.org/api/get?key=/books/OL1728027M', u'http://openlibrary.org/api/get?key=/books/OL871682M', u'http://openlibrary.org/api/get?key=/books/OL3575247M', u'http://openlibrary.org/api/get?key=/books/OL22466882M', u'http://openlibrary.org/api/get?key=/books/OL667942M', u'http://openlibrary.org/api/get?key=/books/OL3702262M', u'http://openlibrary.org/api/get?key=/books/OL14503574M', u'http://openlibrary.org/api/get?key=/books/OL4961081M', u'http://openlibrary.org/api/get?key=/books/OL689252M', u'http://openlibrary.org/api/get?key=/books/OL574421M', u'http://openlibrary.org/api/get?key=/books/OL2220774M', u'http://openlibrary.org/api/get?key=/books/OL576192M', u'http://openlibrary.org/api/get?key=/books/OL11101523M', u'http://openlibrary.org/api/get?key=/books/OL2189285M', u'http://openlibrary.org/api/get?key=/books/OL24087464M', u'http://openlibrary.org/api/get?key=/books/OL1885857M', u'http://openlibrary.org/api/get?key=/books/OL11761367M', u'http://openlibrary.org/api/get?key=/books/OL761707M', u'http://openlibrary.org/api/get?key=/books/OL7893193M', u'http://openlibrary.org/api/get?key=/books/OL2056711M', u'http://openlibrary.org/api/get?key=/books/OL1082260M', u'http://openlibrary.org/api/get?key=/books/OL5290614M', u'http://openlibrary.org/api/get?key=/books/OL7857047M', u'http://openlibrary.org/api/get?key=/books/OL7985596M', u'http://openlibrary.org/api/get?key=/books/OL5794097M', u'http://openlibrary.org/api/get?key=/books/OL4264754M', u'http://openlibrary.org/api/get?key=/books/OL11405441M', u'http://openlibrary.org/api/get?key=/books/OL3183180M', u'http://openlibrary.org/api/get?key=/books/OL61813M', u'http://openlibrary.org/api/get?key=/books/OL2874234M', u'http://openlibrary.org/api/get?key=/books/OL1308552M', u'http://openlibrary.org/api/get?key=/books/OL9549684M', u'http://openlibrary.org/api/get?key=/books/OL5680623M', u'http://openlibrary.org/api/get?key=/books/OL7234372M', u'http://openlibrary.org/api/get?key=/books/OL11771194M', u'http://openlibrary.org/api/get?key=/books/OL660475M', u'http://openlibrary.org/api/get?key=/books/OL7649463M', u'http://openlibrary.org/api/get?key=/books/OL7710085M', u'http://openlibrary.org/api/get?key=/books/OL16562550M', u'http://openlibrary.org/api/get?key=/books/OL7946158M', u'http://openlibrary.org/api/get?key=/books/OL7565775M', u'http://openlibrary.org/api/get?key=/books/OL399897M', u'http://openlibrary.org/api/get?key=/books/OL13500196M', u'http://openlibrary.org/api/get?key=/books/OL1889681M', u'http://openlibrary.org/api/get?key=/books/OL11748408M', u'http://openlibrary.org/api/get?key=/books/OL825674M', u'http://openlibrary.org/api/get?key=/books/OL8658173M', u'http://openlibrary.org/api/get?key=/books/OL7661536M', u'http://openlibrary.org/api/get?key=/books/OL17798897M', u'http://openlibrary.org/api/get?key=/books/OL7818532M', u'http://openlibrary.org/api/get?key=/books/OL8326150M', u'http://openlibrary.org/api/get?key=/books/OL6680269M', u'http://openlibrary.org/api/get?key=/books/OL21116193M', u'http://openlibrary.org/api/get?key=/books/OL633598M', u'http://openlibrary.org/api/get?key=/books/OL15560949M', u'http://openlibrary.org/api/get?key=/books/OL6470083M', u'http://openlibrary.org/api/get?key=/books/OL1883149M', u'http://openlibrary.org/api/get?key=/books/OL8300055M', u'http://openlibrary.org/api/get?key=/books/OL9852757M', u'http://openlibrary.org/api/get?key=/books/OL3402294M', u'http://openlibrary.org/api/get?key=/books/OL3284977M', u'http://openlibrary.org/api/get?key=/books/OL22013191M', u'http://openlibrary.org/api/get?key=/books/OL3163188M', u'http://openlibrary.org/api/get?key=/books/OL7877836M', u'http://openlibrary.org/api/get?key=/books/OL2027534M', u'http://openlibrary.org/api/get?key=/books/OL3486065M', u'http://openlibrary.org/api/get?key=/books/OL2320320M', u'http://openlibrary.org/api/get?key=/books/OL14326040M', u'http://openlibrary.org/api/get?key=/books/OL1309290M', u'http://openlibrary.org/api/get?key=/books/OL19331108M', u'http://openlibrary.org/api/get?key=/books/OL1888989M', u'http://openlibrary.org/api/get?key=/books/OL1089727M', u'http://openlibrary.org/api/get?key=/books/OL2244965M', u'http://openlibrary.org/api/get?key=/books/OL806372M', u'http://openlibrary.org/api/get?key=/books/OL672091M', u'http://openlibrary.org/api/get?key=/books/OL7565453M', u'http://openlibrary.org/api/get?key=/books/OL1712916M', u'http://openlibrary.org/api/get?key=/books/OL16690232M', u'http://openlibrary.org/api/get?key=/books/OL11758151M', u'http://openlibrary.org/api/get?key=/books/OL7283742M', u'http://openlibrary.org/api/get?key=/books/OL7567375M', u'http://openlibrary.org/api/get?key=/books/OL12876825M', u'http://openlibrary.org/api/get?key=/books/OL8714175M', u'http://openlibrary.org/api/get?key=/books/OL11758843M', u'http://openlibrary.org/api/get?key=/books/OL444326M', u'http://openlibrary.org/api/get?key=/books/OL3687773M', u'http://openlibrary.org/api/get?key=/books/OL13809408M', u'http://openlibrary.org/api/get?key=/books/OL51049M', u'http://openlibrary.org/api/get?key=/books/OL388629M', u'http://openlibrary.org/api/get?key=/books/OL5653459M', u'http://openlibrary.org/api/get?key=/books/OL1402892M', u'http://openlibrary.org/api/get?key=/books/OL921893M', u'http://openlibrary.org/api/get?key=/books/OL11427743M', u'http://openlibrary.org/api/get?key=/books/OL3428664M', u'http://openlibrary.org/api/get?key=/books/OL8909706M', u'http://openlibrary.org/api/get?key=/books/OL7954439M', u'http://openlibrary.org/api/get?key=/books/OL3304982M', u'http://openlibrary.org/api/get?key=/books/OL2729261M', u'http://openlibrary.org/api/get?key=/books/OL17621797M', u'http://openlibrary.org/api/get?key=/books/OL1141997M', u'http://openlibrary.org/api/get?key=/books/OL3407729M', u'http://openlibrary.org/api/get?key=/books/OL7202301M', u'http://openlibrary.org/api/get?key=/books/OL1712076M', u'http://openlibrary.org/api/get?key=/books/OL9071398M', u'http://openlibrary.org/api/get?key=/books/OL1580356M', u'http://openlibrary.org/api/get?key=/books/OL2059975M', u'http://openlibrary.org/api/get?key=/books/OL12317574M', u'http://openlibrary.org/api/get?key=/books/OL1556904M', u'http://openlibrary.org/api/get?key=/books/OL3693769M', u'http://openlibrary.org/api/get?key=/books/OL1920343M', u'http://openlibrary.org/api/get?key=/books/OL359749M', u'http://openlibrary.org/api/get?key=/books/OL7833673M', u'http://openlibrary.org/api/get?key=/books/OL667183M', u'http://openlibrary.org/api/get?key=/books/OL781135M', u'http://openlibrary.org/api/get?key=/books/OL1183386M', u'http://openlibrary.org/api/get?key=/books/OL56401M', u'http://openlibrary.org/api/get?key=/books/OL5231703M', u'http://openlibrary.org/api/get?key=/books/OL7921888M', u'http://openlibrary.org/api/get?key=/books/OL3560217M', u'http://openlibrary.org/api/get?key=/books/OL16817420M', u'http://openlibrary.org/api/get?key=/books/OL2045215M', u'http://openlibrary.org/api/get?key=/books/OL1864074M', u'http://openlibrary.org/api/get?key=/books/OL3547514M', u'http://openlibrary.org/api/get?key=/books/OL7915055M', u'http://openlibrary.org/api/get?key=/books/OL2714436M', u'http://openlibrary.org/api/get?key=/books/OL23735410M', u'http://openlibrary.org/api/get?key=/books/OL2557678M', u'http://openlibrary.org/api/get?key=/books/OL9541605M', u'http://openlibrary.org/api/get?key=/books/OL3313274M', u'http://openlibrary.org/api/get?key=/books/OL59253M', u'http://openlibrary.org/api/get?key=/books/OL4379325M', u'http://openlibrary.org/api/get?key=/books/OL4954791M', u'http://openlibrary.org/api/get?key=/books/OL3785369M', u'http://openlibrary.org/api/get?key=/books/OL3705019M', u'http://openlibrary.org/api/get?key=/books/OL7586626M', u'http://openlibrary.org/api/get?key=/books/OL794463M', u'http://openlibrary.org/api/get?key=/books/OL5336993M', u'http://openlibrary.org/api/get?key=/books/OL986933M', u'http://openlibrary.org/api/get?key=/books/OL3784738M', u'http://openlibrary.org/api/get?key=/books/OL7565530M', u'http://openlibrary.org/api/get?key=/books/OL5002152M', u'http://openlibrary.org/api/get?key=/books/OL7173072M', u'http://openlibrary.org/api/get?key=/books/OL61652M', u'http://openlibrary.org/api/get?key=/books/OL1070837M', u'http://openlibrary.org/api/get?key=/books/OL6212439M', u'http://openlibrary.org/api/get?key=/books/OL4548630M', u'http://openlibrary.org/api/get?key=/books/OL8241192M', u'http://openlibrary.org/api/get?key=/books/OL7244328M', u'http://openlibrary.org/api/get?key=/books/OL575996M', u'http://openlibrary.org/api/get?key=/books/OL13604625M', u'http://openlibrary.org/api/get?key=/books/OL1274436M', u'http://openlibrary.org/api/get?key=/books/OL355225M', u'http://openlibrary.org/api/get?key=/books/OL9620096M', u'http://openlibrary.org/api/get?key=/books/OL7909254M', u'http://openlibrary.org/api/get?key=/books/OL3692926M', u'http://openlibrary.org/api/get?key=/books/OL1273249M', u'http://openlibrary.org/api/get?key=/books/OL1004269M', u'http://openlibrary.org/api/get?key=/books/OL5888661M', u'http://openlibrary.org/api/get?key=/books/OL3310125M', u'http://openlibrary.org/api/get?key=/books/OL2711500M', u'http://openlibrary.org/api/get?key=/books/OL998050M', u'http://openlibrary.org/api/get?key=/books/OL7414383M', u'http://openlibrary.org/api/get?key=/books/OL8859653M', u'http://openlibrary.org/api/get?key=/books/OL497025M', u'http://openlibrary.org/api/get?key=/books/OL11582218M', u'http://openlibrary.org/api/get?key=/books/OL6800378M', u'http://openlibrary.org/api/get?key=/books/OL7586603M', u'http://openlibrary.org/api/get?key=/books/OL980809M', u'http://openlibrary.org/api/get?key=/books/OL681550M', u'http://openlibrary.org/api/get?key=/books/OL20775197M', u'http://openlibrary.org/api/get?key=/books/OL5325133M', u'http://openlibrary.org/api/get?key=/books/OL13777444M', u'http://openlibrary.org/api/get?key=/books/OL8808890M', u'http://openlibrary.org/api/get?key=/books/OL8711714M', u'http://openlibrary.org/api/get?key=/books/OL9381342M', u'http://openlibrary.org/api/get?key=/books/OL11758033M', u'http://openlibrary.org/api/get?key=/books/OL7414023M', u'http://openlibrary.org/api/get?key=/books/OL991850M', u'http://openlibrary.org/api/get?key=/books/OL19450021M', u'http://openlibrary.org/api/get?key=/books/OL10582152M', u'http://openlibrary.org/api/get?key=/books/OL3672596M', u'http://openlibrary.org/api/get?key=/books/OL7346139M', u'http://openlibrary.org/api/get?key=/books/OL4963079M', u'http://openlibrary.org/api/get?key=/books/OL3382756M', u'http://openlibrary.org/api/get?key=/books/OL1888944M', u'http://openlibrary.org/api/get?key=/books/OL1739269M', u'http://openlibrary.org/api/get?key=/books/OL6722863M', u'http://openlibrary.org/api/get?key=/books/OL7946248M', u'http://openlibrary.org/api/get?key=/books/OL7586604M', u'http://openlibrary.org/api/get?key=/books/OL16753516M', u'http://openlibrary.org/api/get?key=/books/OL1417639M', u'http://openlibrary.org/api/get?key=/books/OL1471674M', u'http://openlibrary.org/api/get?key=/books/OL1165889M', u'http://openlibrary.org/api/get?key=/books/OL8737697M', u'http://openlibrary.org/api/get?key=/books/OL3314799M', u'http://openlibrary.org/api/get?key=/books/OL7818089M', u'http://openlibrary.org/api/get?key=/books/OL9663121M', u'http://openlibrary.org/api/get?key=/books/OL539149M', u'http://openlibrary.org/api/get?key=/books/OL7395367M', u'http://openlibrary.org/api/get?key=/books/OL3948636M', u'http://openlibrary.org/api/get?key=/books/OL3396049M', u'http://openlibrary.org/api/get?key=/books/OL10151378M', u'http://openlibrary.org/api/get?key=/books/OL4130301M', u'http://openlibrary.org/api/get?key=/books/OL7695235M', u'http://openlibrary.org/api/get?key=/books/OL1125861M', u'http://openlibrary.org/api/get?key=/books/OL3354117M', u'http://openlibrary.org/api/get?key=/books/OL6094127M', u'http://openlibrary.org/api/get?key=/books/OL15064289M', u'http://openlibrary.org/api/get?key=/books/OL1744071M', u'http://openlibrary.org/api/get?key=/books/OL6208845M', u'http://openlibrary.org/api/get?key=/books/OL7570031M', u'http://openlibrary.org/api/get?key=/books/OL1123283M', u'http://openlibrary.org/api/get?key=/books/OL13527462M', u'http://openlibrary.org/api/get?key=/books/OL8315320M', u'http://openlibrary.org/api/get?key=/books/OL8650315M', u'http://openlibrary.org/api/get?key=/books/OL4100160M', u'http://openlibrary.org/api/get?key=/books/OL23631365M', u'http://openlibrary.org/api/get?key=/books/OL788253M', u'http://openlibrary.org/api/get?key=/books/OL970419M', u'http://openlibrary.org/api/get?key=/books/OL7649470M', u'http://openlibrary.org/api/get?key=/books/OL5858093M', u'http://openlibrary.org/api/get?key=/books/OL10916465M', u'http://openlibrary.org/api/get?key=/books/OL3568153M', u'http://openlibrary.org/api/get?key=/books/OL8713388M', u'http://openlibrary.org/api/get?key=/books/OL7914847M', u'http://openlibrary.org/api/get?key=/books/OL3392895M', u'http://openlibrary.org/api/get?key=/books/OL1111620M', u'http://openlibrary.org/api/get?key=/books/OL7236782M', u'http://openlibrary.org/api/get?key=/books/OL6136578M', u'http://openlibrary.org/api/get?key=/books/OL21509615M', u'http://openlibrary.org/api/get?key=/books/OL826185M', u'http://openlibrary.org/api/get?key=/books/OL9483960M', u'http://openlibrary.org/api/get?key=/books/OL1884566M', u'http://openlibrary.org/api/get?key=/books/OL9815841M', u'http://openlibrary.org/api/get?key=/books/OL6797367M', u'http://openlibrary.org/api/get?key=/books/OL52082M', u'http://openlibrary.org/api/get?key=/books/OL695522M', u'http://openlibrary.org/api/get?key=/books/OL370088M', u'http://openlibrary.org/api/get?key=/books/OL7315106M', u'http://openlibrary.org/api/get?key=/books/OL4203576M', u'http://openlibrary.org/api/get?key=/books/OL7586610M', u'http://openlibrary.org/api/get?key=/books/OL10635610M', u'http://openlibrary.org/api/get?key=/books/OL6781059M', u'http://openlibrary.org/api/get?key=/books/OL8859687M', u'http://openlibrary.org/api/get?key=/books/OL3943235M', u'http://openlibrary.org/api/get?key=/books/OL11724196M', u'http://openlibrary.org/api/get?key=/books/OL9593063M', u'http://openlibrary.org/api/get?key=/books/OL8109349M', u'http://openlibrary.org/api/get?key=/books/OL7821947M', u'http://openlibrary.org/api/get?key=/books/OL6365800M', u'http://openlibrary.org/api/get?key=/books/OL1472937M', u'http://openlibrary.org/api/get?key=/books/OL11399820M', u'http://openlibrary.org/api/get?key=/books/OL3665455M', u'http://openlibrary.org/api/get?key=/books/OL1104792M', u'http://openlibrary.org/api/get?key=/books/OL1924519M', u'http://openlibrary.org/api/get?key=/books/OL11675410M', u'http://openlibrary.org/api/get?key=/books/OL8907627M', u'http://openlibrary.org/api/get?key=/books/OL7683212M', u'http://openlibrary.org/api/get?key=/books/OL3937822M', u'http://openlibrary.org/api/get?key=/books/OL1432363M', u'http://openlibrary.org/api/get?key=/books/OL1154262M', u'http://openlibrary.org/api/get?key=/books/OL59707M', u'http://openlibrary.org/api/get?key=/books/OL1081351M', u'http://openlibrary.org/api/get?key=/books/OL8192789M', u'http://openlibrary.org/api/get?key=/books/OL3688653M', u'http://openlibrary.org/api/get?key=/books/OL59377M', u'http://openlibrary.org/api/get?key=/books/OL5876893M', u'http://openlibrary.org/api/get?key=/books/OL7586607M', u'http://openlibrary.org/api/get?key=/books/OL8745435M', u'http://openlibrary.org/api/get?key=/books/OL12934508M', u'http://openlibrary.org/api/get?key=/books/OL3678345M', u'http://openlibrary.org/api/get?key=/books/OL6318896M', u'http://openlibrary.org/api/get?key=/books/OL3950670M', u'http://openlibrary.org/api/get?key=/books/OL2651670M', u'http://openlibrary.org/api/get?key=/books/OL4604389M', u'http://openlibrary.org/api/get?key=/books/OL2939631M', u'http://openlibrary.org/api/get?key=/books/OL680386M', u'http://openlibrary.org/api/get?key=/books/OL7429767M', u'http://openlibrary.org/api/get?key=/books/OL2392972M', u'http://openlibrary.org/api/get?key=/books/OL7858213M', u'http://openlibrary.org/api/get?key=/books/OL3696379M', u'http://openlibrary.org/api/get?key=/books/OL2199465M', u'http://openlibrary.org/api/get?key=/books/OL5877742M', u'http://openlibrary.org/api/get?key=/books/OL7586608M', u'http://openlibrary.org/api/get?key=/books/OL3316684M', u'http://openlibrary.org/api/get?key=/books/OL17076867M', u'http://openlibrary.org/api/get?key=/books/OL3393217M', u'http://openlibrary.org/api/get?key=/books/OL23796333M', u'http://openlibrary.org/api/get?key=/books/OL20753798M', u'http://openlibrary.org/api/get?key=/books/OL9274534M', u'http://openlibrary.org/api/get?key=/books/OL4283195M', u'http://openlibrary.org/api/get?key=/books/OL2710156M', u'http://openlibrary.org/api/get?key=/books/OL24088830M', u'http://openlibrary.org/api/get?key=/books/OL707666M', u'http://openlibrary.org/api/get?key=/books/OL760063M', u'http://openlibrary.org/api/get?key=/books/OL8849438M', u'http://openlibrary.org/api/get?key=/books/OL724936M', u'http://openlibrary.org/api/get?key=/books/OL1440992M', u'http://openlibrary.org/api/get?key=/books/OL7428668M', u'http://openlibrary.org/api/get?key=/books/OL23164987M', u'http://openlibrary.org/api/get?key=/books/OL3080881M', u'http://openlibrary.org/api/get?key=/books/OL7961394M', u'http://openlibrary.org/api/get?key=/books/OL3700716M', u'http://openlibrary.org/api/get?key=/books/OL7489598M', u'http://openlibrary.org/api/get?key=/books/OL7255851M', u'http://openlibrary.org/api/get?key=/books/OL12337877M', u'http://openlibrary.org/api/get?key=/books/OL1632725M', u'http://openlibrary.org/api/get?key=/books/OL8703502M', u'http://openlibrary.org/api/get?key=/books/OL3946847M', u'http://openlibrary.org/api/get?key=/books/OL24088753M', u'http://openlibrary.org/api/get?key=/books/OL5880166M', u'http://openlibrary.org/api/get?key=/books/OL8899154M', u'http://openlibrary.org/api/get?key=/books/OL1025140M', u'http://openlibrary.org/api/get?key=/books/OL2041665M', u'http://openlibrary.org/api/get?key=/books/OL6137190M', u'http://openlibrary.org/api/get?key=/books/OL6693490M', u'http://openlibrary.org/api/get?key=/books/OL2864683M', u'http://openlibrary.org/api/get?key=/books/OL628837M', u'http://openlibrary.org/api/get?key=/books/OL2993911M', u'http://openlibrary.org/api/get?key=/books/OL7962754M', u'http://openlibrary.org/api/get?key=/books/OL8241458M', u'http://openlibrary.org/api/get?key=/books/OL5337807M', u'http://openlibrary.org/api/get?key=/books/OL7345247M', u'http://openlibrary.org/api/get?key=/books/OL2525899M', u'http://openlibrary.org/api/get?key=/books/OL2732775M', u'http://openlibrary.org/api/get?key=/books/OL2373708M', u'http://openlibrary.org/api/get?key=/books/OL8276783M', u'http://openlibrary.org/api/get?key=/books/OL1923295M', u'http://openlibrary.org/api/get?key=/books/OL6615870M', u'http://openlibrary.org/api/get?key=/books/OL18276870M', u'http://openlibrary.org/api/get?key=/books/OL7349902M', u'http://openlibrary.org/api/get?key=/books/OL8192747M', u'http://openlibrary.org/api/get?key=/books/OL7817799M', u'http://openlibrary.org/api/get?key=/books/OL1700764M', u'http://openlibrary.org/api/get?key=/books/OL2186483M', u'http://openlibrary.org/api/get?key=/books/OL7319953M', u'http://openlibrary.org/api/get?key=/books/OL8566174M', u'http://openlibrary.org/api/get?key=/books/OL8439581M', u'http://openlibrary.org/api/get?key=/books/OL7277847M', u'http://openlibrary.org/api/get?key=/books/OL5656918M', u'http://openlibrary.org/api/get?key=/books/OL3301816M', u'http://openlibrary.org/api/get?key=/books/OL23654541M', u'http://openlibrary.org/api/get?key=/books/OL975097M', u'http://openlibrary.org/api/get?key=/books/OL7292719M', u'http://openlibrary.org/api/get?key=/books/OL7586602M', u'http://openlibrary.org/api/get?key=/books/OL275567M', u'http://openlibrary.org/api/get?key=/books/OL11128966M', u'http://openlibrary.org/api/get?key=/books/OL7699215M', u'http://openlibrary.org/api/get?key=/books/OL400898M', u'http://openlibrary.org/api/get?key=/books/OL7317592M', u'http://openlibrary.org/api/get?key=/books/OL2164014M', u'http://openlibrary.org/api/get?key=/books/OL1754795M', u'http://openlibrary.org/api/get?key=/books/OL7777688M', u'http://openlibrary.org/api/get?key=/books/OL7815819M', u'http://openlibrary.org/api/get?key=/books/OL6530384M', u'http://openlibrary.org/api/get?key=/books/OL10706719M', u'http://openlibrary.org/api/get?key=/books/OL7429772M', u'http://openlibrary.org/api/get?key=/books/OL5463065M', u'http://openlibrary.org/api/get?key=/books/OL4751369M', u'http://openlibrary.org/api/get?key=/books/OL1024943M', u'http://openlibrary.org/api/get?key=/books/OL8548479M', u'http://openlibrary.org/api/get?key=/books/OL4072895M', u'http://openlibrary.org/api/get?key=/books/OL606265M', u'http://openlibrary.org/api/get?key=/books/OL7239310M', u'http://openlibrary.org/api/get?key=/books/OL1034527M', u'http://openlibrary.org/api/get?key=/books/OL8075049M', u'http://openlibrary.org/api/get?key=/books/OL911962M', u'http://openlibrary.org/api/get?key=/books/OL1561688M', u'http://openlibrary.org/api/get?key=/books/OL4110892M', u'http://openlibrary.org/api/get?key=/books/OL12036825M', u'http://openlibrary.org/api/get?key=/books/OL7360391M', u'http://openlibrary.org/api/get?key=/books/OL353857M', u'http://openlibrary.org/api/get?key=/books/OL16631336M', u'http://openlibrary.org/api/get?key=/books/OL7946180M', u'http://openlibrary.org/api/get?key=/books/OL3699390M', u'http://openlibrary.org/api/get?key=/books/OL30928M', u'http://openlibrary.org/api/get?key=/books/OL10575088M', u'http://openlibrary.org/api/get?key=/books/OL6577761M', u'http://openlibrary.org/api/get?key=/books/OL3437006M', u'http://openlibrary.org/api/get?key=/books/OL5059665M', u'http://openlibrary.org/api/get?key=/books/OL9644709M', u'http://openlibrary.org/api/get?key=/books/OL393089M', u'http://openlibrary.org/api/get?key=/books/OL714380M', u'http://openlibrary.org/api/get?key=/books/OL3305465M', u'http://openlibrary.org/api/get?key=/books/OL9796169M', u'http://openlibrary.org/api/get?key=/books/OL3103687M', u'http://openlibrary.org/api/get?key=/books/OL5716996M', u'http://openlibrary.org/api/get?key=/books/OL793963M', u'http://openlibrary.org/api/get?key=/books/OL3453340M', u'http://openlibrary.org/api/get?key=/books/OL21896257M', u'http://openlibrary.org/api/get?key=/books/OL10669866M', u'http://openlibrary.org/api/get?key=/books/OL7136234M', u'http://openlibrary.org/api/get?key=/books/OL5324421M', u'http://openlibrary.org/api/get?key=/books/OL7584981M', u'http://openlibrary.org/api/get?key=/books/OL984889M', u'http://openlibrary.org/api/get?key=/books/OL1937594M', u'http://openlibrary.org/api/get?key=/books/OL8453171M', u'http://openlibrary.org/api/get?key=/books/OL3397914M', u'http://openlibrary.org/api/get?key=/books/OL2466795M', u'http://openlibrary.org/api/get?key=/books/OL1289382M', u'http://openlibrary.org/api/get?key=/books/OL559194M', u'http://openlibrary.org/api/get?key=/books/OL783988M', u'http://openlibrary.org/api/get?key=/books/OL9869398M', u'http://openlibrary.org/api/get?key=/books/OL3955579M', u'http://openlibrary.org/api/get?key=/books/OL11721964M', u'http://openlibrary.org/api/get?key=/books/OL5460660M', 'http://openlibrary.org/api/get?key=/books/OL16029951W', u'http://openlibrary.org/api/get?key=/books/OL10464230M', u'http://openlibrary.org/api/get?key=/books/OL3354232M', u'http://openlibrary.org/api/get?key=/books/OL780109M', u'http://openlibrary.org/api/get?key=/books/OL9565670M', u'http://openlibrary.org/api/get?key=/books/OL22549594M', u'http://openlibrary.org/api/get?key=/books/OL7414090M', u'http://openlibrary.org/api/get?key=/books/OL5632980M', u'http://openlibrary.org/api/get?key=/books/OL2757283M', u'http://openlibrary.org/api/get?key=/books/OL6791325M', u'http://openlibrary.org/api/get?key=/books/OL3283829M', u'http://openlibrary.org/api/get?key=/books/OL2056821M', u'http://openlibrary.org/api/get?key=/books/OL3507247M', u'http://openlibrary.org/api/get?key=/books/OL3479883M', u'http://openlibrary.org/api/get?key=/books/OL19851936M', u'http://openlibrary.org/api/get?key=/books/OL14826327M', u'http://openlibrary.org/api/get?key=/books/OL7861458M', u'http://openlibrary.org/api/get?key=/books/OL997941M', u'http://openlibrary.org/api/get?key=/books/OL23735887M', u'http://openlibrary.org/api/get?key=/books/OL3398120M', u'http://openlibrary.org/api/get?key=/books/OL12884100M', u'http://openlibrary.org/api/get?key=/books/OL4917247M', u'http://openlibrary.org/api/get?key=/books/OL3677507M', u'http://openlibrary.org/api/get?key=/books/OL2536227M', u'http://openlibrary.org/api/get?key=/books/OL8892254M', u'http://openlibrary.org/api/get?key=/books/OL7584771M', u'http://openlibrary.org/api/get?key=/books/OL1995467M', u'http://openlibrary.org/api/get?key=/books/OL3388997M', u'http://openlibrary.org/api/get?key=/books/OL23247010M', u'http://openlibrary.org/api/get?key=/books/OL9486509M', u'http://openlibrary.org/api/get?key=/books/OL685577M', u'http://openlibrary.org/api/get?key=/books/OL13301313M', u'http://openlibrary.org/api/get?key=/books/OL10465600M', u'http://openlibrary.org/api/get?key=/books/OL16831532M', u'http://openlibrary.org/api/get?key=/books/OL3327496M', u'http://openlibrary.org/api/get?key=/books/OL6313167M', u'http://openlibrary.org/api/get?key=/books/OL6550072M', u'http://openlibrary.org/api/get?key=/books/OL8859701M', u'http://openlibrary.org/api/get?key=/books/OL7838064M', u'http://openlibrary.org/api/get?key=/books/OL809322M', u'http://openlibrary.org/api/get?key=/books/OL341917M', u'http://openlibrary.org/api/get?key=/books/OL1889004M', u'http://openlibrary.org/api/get?key=/books/OL118402M', u'http://openlibrary.org/api/get?key=/books/OL7456285M', u'http://openlibrary.org/api/get?key=/books/OL4911865M', u'http://openlibrary.org/api/get?key=/books/OL6937460M', u'http://openlibrary.org/api/get?key=/books/OL3503814M', u'http://openlibrary.org/api/get?key=/books/OL7569909M', u'http://openlibrary.org/api/get?key=/books/OL781609M', u'http://openlibrary.org/api/get?key=/books/OL5720536M', u'http://openlibrary.org/api/get?key=/books/OL10608721M', u'http://openlibrary.org/api/get?key=/books/OL7962182M', u'http://openlibrary.org/api/get?key=/books/OL18055161M', u'http://openlibrary.org/api/get?key=/books/OL6010719M', u'http://openlibrary.org/api/get?key=/books/OL976988M', u'http://openlibrary.org/api/get?key=/books/OL8137725M', u'http://openlibrary.org/api/get?key=/books/OL9272247M', u'http://openlibrary.org/api/get?key=/books/OL9681442M', u'http://openlibrary.org/api/get?key=/books/OL3174095M', u'http://openlibrary.org/api/get?key=/books/OL3191106M', u'http://openlibrary.org/api/get?key=/books/OL3422342M', u'http://openlibrary.org/api/get?key=/books/OL7524908M', u'http://openlibrary.org/api/get?key=/books/OL5161055M', u'http://openlibrary.org/api/get?key=/books/OL2934255M', u'http://openlibrary.org/api/get?key=/books/OL10256496M', u'http://openlibrary.org/api/get?key=/books/OL7428718M', u'http://openlibrary.org/api/get?key=/books/OL10658513M', u'http://openlibrary.org/api/get?key=/books/OL9659991M', u'http://openlibrary.org/api/get?key=/books/OL4541302M', u'http://openlibrary.org/api/get?key=/books/OL3556609M', u'http://openlibrary.org/api/get?key=/books/OL7586611M', u'http://openlibrary.org/api/get?key=/books/OL9210567M', u'http://openlibrary.org/api/get?key=/books/OL5755954M', u'http://openlibrary.org/api/get?key=/books/OL2448457M', u'http://openlibrary.org/api/get?key=/books/OL4925132M', u'http://openlibrary.org/api/get?key=/books/OL2003098M', u'http://openlibrary.org/api/get?key=/books/OL7260373M', u'http://openlibrary.org/api/get?key=/books/OL6841963M', u'http://openlibrary.org/api/get?key=/books/OL20880200M', u'http://openlibrary.org/api/get?key=/books/OL6901839M', u'http://openlibrary.org/api/get?key=/books/OL23535362M', u'http://openlibrary.org/api/get?key=/books/OL296308M', u'http://openlibrary.org/api/get?key=/books/OL2742791M', u'http://openlibrary.org/api/get?key=/books/OL3416011M', u'http://openlibrary.org/api/get?key=/books/OL426783M', u'http://openlibrary.org/api/get?key=/books/OL9952644M', u'http://openlibrary.org/api/get?key=/books/OL9765394M', u'http://openlibrary.org/api/get?key=/books/OL3955208M', u'http://openlibrary.org/api/get?key=/books/OL22666087M', u'http://openlibrary.org/api/get?key=/books/OL72376M', u'http://openlibrary.org/api/get?key=/books/OL14967577M', u'http://openlibrary.org/api/get?key=/books/OL9496150M', u'http://openlibrary.org/api/get?key=/books/OL31096M', u'http://openlibrary.org/api/get?key=/books/OL1099842M', u'http://openlibrary.org/api/get?key=/books/OL2279238M', u'http://openlibrary.org/api/get?key=/books/OL5186696M', u'http://openlibrary.org/api/get?key=/books/OL7351671M', u'http://openlibrary.org/api/get?key=/books/OL5793957M', u'http://openlibrary.org/api/get?key=/books/OL22529142M', u'http://openlibrary.org/api/get?key=/books/OL7893292M', u'http://openlibrary.org/api/get?key=/books/OL4547018M', u'http://openlibrary.org/api/get?key=/books/OL319743M', u'http://openlibrary.org/api/get?key=/books/OL731599M', u'http://openlibrary.org/api/get?key=/books/OL3313526M', u'http://openlibrary.org/api/get?key=/books/OL24013771M', u'http://openlibrary.org/api/get?key=/books/OL8106037M', u'http://openlibrary.org/api/get?key=/books/OL55980M', u'http://openlibrary.org/api/get?key=/books/OL2319611M', u'http://openlibrary.org/api/get?key=/books/OL8109289M', u'http://openlibrary.org/api/get?key=/books/OL7680043M', u'http://openlibrary.org/api/get?key=/books/OL20152389M', u'http://openlibrary.org/api/get?key=/books/OL8926465M', u'http://openlibrary.org/api/get?key=/books/OL431933M', u'http://openlibrary.org/api/get?key=/books/OL8617181M', u'http://openlibrary.org/api/get?key=/books/OL14262216M', u'http://openlibrary.org/api/get?key=/books/OL3190461M', u'http://openlibrary.org/api/get?key=/books/OL2005200M', u'http://openlibrary.org/api/get?key=/books/OL1102336M', u'http://openlibrary.org/api/get?key=/books/OL398689M', u'http://openlibrary.org/api/get?key=/books/OL306548M', u'http://openlibrary.org/api/get?key=/books/OL24040095M', u'http://openlibrary.org/api/get?key=/books/OL467487M', u'http://openlibrary.org/api/get?key=/books/OL685562M', u'http://openlibrary.org/api/get?key=/books/OL562242M', u'http://openlibrary.org/api/get?key=/books/OL6167480M', u'http://openlibrary.org/api/get?key=/books/OL11764146M', u'http://openlibrary.org/api/get?key=/books/OL3400135M', u'http://openlibrary.org/api/get?key=/books/OL9326085M', u'http://openlibrary.org/api/get?key=/books/OL7921663M', u'http://openlibrary.org/api/get?key=/books/OL7820263M', u'http://openlibrary.org/api/get?key=/books/OL7497757M', u'http://openlibrary.org/api/get?key=/books/OL7500995M', u'http://openlibrary.org/api/get?key=/books/OL9388015M', u'http://openlibrary.org/api/get?key=/books/OL5537281M', u'http://openlibrary.org/api/get?key=/books/OL16635342M', u'http://openlibrary.org/api/get?key=/books/OL9239710M', u'http://openlibrary.org/api/get?key=/books/OL3174961M', u'http://openlibrary.org/api/get?key=/books/OL9466904M', u'http://openlibrary.org/api/get?key=/books/OL2441220M', u'http://openlibrary.org/api/get?key=/books/OL3671001M', u'http://openlibrary.org/api/get?key=/books/OL702371M', u'http://openlibrary.org/api/get?key=/books/OL7641537M', u'http://openlibrary.org/api/get?key=/books/OL7968984M', u'http://openlibrary.org/api/get?key=/books/OL99006M', u'http://openlibrary.org/api/get?key=/books/OL7883151M', u'http://openlibrary.org/api/get?key=/books/OL786857M', u'http://openlibrary.org/api/get?key=/books/OL2385247M', u'http://openlibrary.org/api/get?key=/books/OL3560275M', u'http://openlibrary.org/api/get?key=/books/OL2551780M', u'http://openlibrary.org/api/get?key=/books/OL2822072M', u'http://openlibrary.org/api/get?key=/books/OL1702019M', u'http://openlibrary.org/api/get?key=/books/OL48121M', u'http://openlibrary.org/api/get?key=/books/OL2434253M', u'http://openlibrary.org/api/get?key=/books/OL11746664M', u'http://openlibrary.org/api/get?key=/books/OL467311M', u'http://openlibrary.org/api/get?key=/books/OL8419177M', u'http://openlibrary.org/api/get?key=/books/OL6779601M', u'http://openlibrary.org/api/get?key=/books/OL11589025M', u'http://openlibrary.org/api/get?key=/books/OL3562028M', u'http://openlibrary.org/api/get?key=/books/OL2205542M', u'http://openlibrary.org/api/get?key=/books/OL3952613M', u'http://openlibrary.org/api/get?key=/books/OL3228564M', u'http://openlibrary.org/api/get?key=/books/OL20816759M', u'http://openlibrary.org/api/get?key=/books/OL3067263M', u'http://openlibrary.org/api/get?key=/books/OL23275263M', u'http://openlibrary.org/api/get?key=/books/OL5775692M', u'http://openlibrary.org/api/get?key=/books/OL22180633M', u'http://openlibrary.org/api/get?key=/books/OL7643883M', u'http://openlibrary.org/api/get?key=/books/OL7759438M', u'http://openlibrary.org/api/get?key=/books/OL3383522M', u'http://openlibrary.org/api/get?key=/books/OL48015M', u'http://openlibrary.org/api/get?key=/books/OL1108824M', u'http://openlibrary.org/api/get?key=/books/OL1477286M', u'http://openlibrary.org/api/get?key=/books/OL1881748M', u'http://openlibrary.org/api/get?key=/books/OL3410270M', u'http://openlibrary.org/api/get?key=/books/OL545804M', u'http://openlibrary.org/api/get?key=/books/OL1476494M', u'http://openlibrary.org/api/get?key=/books/OL687804M', u'http://openlibrary.org/api/get?key=/books/OL685348M', u'http://openlibrary.org/api/get?key=/books/OL1867121M', u'http://openlibrary.org/api/get?key=/books/OL8327967M', u'http://openlibrary.org/api/get?key=/books/OL2875776M', u'http://openlibrary.org/api/get?key=/books/OL1648743M', u'http://openlibrary.org/api/get?key=/books/OL10936430M', u'http://openlibrary.org/api/get?key=/books/OL3436802M', u'http://openlibrary.org/api/get?key=/books/OL8437022M', u'http://openlibrary.org/api/get?key=/books/OL3174836M', u'http://openlibrary.org/api/get?key=/books/OL6087979M', u'http://openlibrary.org/api/get?key=/books/OL5386111M', u'http://openlibrary.org/api/get?key=/books/OL381084M', u'http://openlibrary.org/api/get?key=/books/OL592692M', u'http://openlibrary.org/api/get?key=/books/OL7029106M', u'http://openlibrary.org/api/get?key=/books/OL8726334M', u'http://openlibrary.org/api/get?key=/books/OL18565956M', u'http://openlibrary.org/api/get?key=/books/OL1717020M', u'http://openlibrary.org/api/get?key=/books/OL5628137M', u'http://openlibrary.org/api/get?key=/books/OL1080815M', u'http://openlibrary.org/api/get?key=/books/OL3565641M', u'http://openlibrary.org/api/get?key=/books/OL4110609M', u'http://openlibrary.org/api/get?key=/books/OL9299900M', u'http://openlibrary.org/api/get?key=/books/OL5289261M', u'http://openlibrary.org/api/get?key=/books/OL11887868M', u'http://openlibrary.org/api/get?key=/books/OL41345M', u'http://openlibrary.org/api/get?key=/books/OL1560238M', u'http://openlibrary.org/api/get?key=/books/OL1529773M', u'http://openlibrary.org/api/get?key=/books/OL7329766M', u'http://openlibrary.org/api/get?key=/books/OL9214728M', u'http://openlibrary.org/api/get?key=/books/OL23242773M', u'http://openlibrary.org/api/get?key=/books/OL16572280M', u'http://openlibrary.org/api/get?key=/books/OL7885842M', u'http://openlibrary.org/api/get?key=/books/OL785332M', u'http://openlibrary.org/api/get?key=/books/OL7798933M', u'http://openlibrary.org/api/get?key=/books/OL98322M', u'http://openlibrary.org/api/get?key=/books/OL9499639M', u'http://openlibrary.org/api/get?key=/books/OL22842512M', u'http://openlibrary.org/api/get?key=/books/OL6653815M', u'http://openlibrary.org/api/get?key=/books/OL1463065M', u'http://openlibrary.org/api/get?key=/books/OL2254210M', u'http://openlibrary.org/api/get?key=/books/OL1204807M', u'http://openlibrary.org/api/get?key=/books/OL4556497M', u'http://openlibrary.org/api/get?key=/books/OL3417260M', u'http://openlibrary.org/api/get?key=/books/OL19801741M', u'http://openlibrary.org/api/get?key=/books/OL12503027M', u'http://openlibrary.org/api/get?key=/books/OL3954420M', u'http://openlibrary.org/api/get?key=/books/OL3386920M', u'http://openlibrary.org/api/get?key=/books/OL4255574M', u'http://openlibrary.org/api/get?key=/books/OL293702M', u'http://openlibrary.org/api/get?key=/books/OL3284325M', u'http://openlibrary.org/api/get?key=/books/OL8821705M', u'http://openlibrary.org/api/get?key=/books/OL3419896M', u'http://openlibrary.org/api/get?key=/books/OL7673696M', u'http://openlibrary.org/api/get?key=/books/OL10151324M', u'http://openlibrary.org/api/get?key=/books/OL8075256M', u'http://openlibrary.org/api/get?key=/books/OL2540671M', u'http://openlibrary.org/api/get?key=/books/OL6485302M', u'http://openlibrary.org/api/get?key=/books/OL9302520M', u'http://openlibrary.org/api/get?key=/books/OL809384M', u'http://openlibrary.org/api/get?key=/books/OL15535370M', u'http://openlibrary.org/api/get?key=/books/OL1744982M', u'http://openlibrary.org/api/get?key=/books/OL2348799M', u'http://openlibrary.org/api/get?key=/books/OL4409635M', u'http://openlibrary.org/api/get?key=/books/OL17653607M', u'http://openlibrary.org/api/get?key=/books/OL3952499M', u'http://openlibrary.org/api/get?key=/books/OL2040816M', u'http://openlibrary.org/api/get?key=/books/OL2988545M', u'http://openlibrary.org/api/get?key=/books/OL1423376M', u'http://openlibrary.org/api/get?key=/books/OL1117502M', u'http://openlibrary.org/api/get?key=/books/OL7319883M', u'http://openlibrary.org/api/get?key=/books/OL18290883M', u'http://openlibrary.org/api/get?key=/books/OL53924M', u'http://openlibrary.org/api/get?key=/books/OL1138981M', u'http://openlibrary.org/api/get?key=/books/OL1415947M', u'http://openlibrary.org/api/get?key=/books/OL23435624M', u'http://openlibrary.org/api/get?key=/books/OL10543118M', u'http://openlibrary.org/api/get?key=/books/OL9332216M', u'http://openlibrary.org/api/get?key=/books/OL9305752M', u'http://openlibrary.org/api/get?key=/books/OL7201286M', u'http://openlibrary.org/api/get?key=/books/OL3727908M', u'http://openlibrary.org/api/get?key=/books/OL22343348M', u'http://openlibrary.org/api/get?key=/books/OL5552977M', u'http://openlibrary.org/api/get?key=/books/OL8354975M', u'http://openlibrary.org/api/get?key=/books/OL808384M', u'http://openlibrary.org/api/get?key=/books/OL5756978M', u'http://openlibrary.org/api/get?key=/books/OL2851082M', u'http://openlibrary.org/api/get?key=/books/OL3177976M', u'http://openlibrary.org/api/get?key=/books/OL8865089M', u'http://openlibrary.org/api/get?key=/books/OL17766496M', u'http://openlibrary.org/api/get?key=/books/OL2219009M', u'http://openlibrary.org/api/get?key=/books/OL6249916M', u'http://openlibrary.org/api/get?key=/books/OL9908801M', u'http://openlibrary.org/api/get?key=/books/OL3513030M', u'http://openlibrary.org/api/get?key=/books/OL1229403M', u'http://openlibrary.org/api/get?key=/books/OL8458051M', u'http://openlibrary.org/api/get?key=/books/OL20966907M', u'http://openlibrary.org/api/get?key=/books/OL9646710M', u'http://openlibrary.org/api/get?key=/books/OL7710084M', u'http://openlibrary.org/api/get?key=/books/OL8658172M', u'http://openlibrary.org/api/get?key=/books/OL1211258M', u'http://openlibrary.org/api/get?key=/books/OL7260013M', u'http://openlibrary.org/api/get?key=/books/OL18288468M', u'http://openlibrary.org/api/get?key=/books/OL7184999M', u'http://openlibrary.org/api/get?key=/books/OL8681823M', u'http://openlibrary.org/api/get?key=/books/OL7814409M', u'http://openlibrary.org/api/get?key=/books/OL8306776M', u'http://openlibrary.org/api/get?key=/books/OL9563154M', u'http://openlibrary.org/api/get?key=/books/OL2743791M', u'http://openlibrary.org/api/get?key=/books/OL5874200M', u'http://openlibrary.org/api/get?key=/books/OL11715919M', u'http://openlibrary.org/api/get?key=/books/OL4833273M'])

SUBJECTS = [
    'Science Fiction',
    'Totalitarianism',
    'Totalitarian',
    'End of the world',
    'Rapture Christian',
    'Nuclear warfare',
    'Nuclear war',
    'Regression Civilization',
    'Plague',
    'Tribulation Christian',
    'Imaginary wars and battles',
    'Apocalypse',
    'Apocalyptic',
    'Dystopia',
    'Dystopian',
    'Utopia',
    'Utopian',
]


def strip_html(value):
    return re.compile(r'</?\S([^=]*=(\s*"[^"]*"|\s*\'[^\']*\'|\S*)|[^>])*?>', re.IGNORECASE).sub('', value)


def get_isbns():
    """
    Function for getting a list of isbn numbers for analysis.
    """

    def _process_search(content, subject):
        """
        Private function for processing search results.
        """
        print "(%s) %s" % (content['num_found'], subject)
        for book in content['docs']:

            try:
                for isbn in book['isbn']:
                    ISBN.add(isbn)
                print '\t%s' % book['title_suggest']
            except KeyError:
                continue

    ISBN = Set([])

    for subject in SUBJECTS:
        r = requests.get(subject_url(subject))

        try:
            _process_search(json.loads(r.content), subject)

        except ValueError:
            continue

    with open('isbns.txt', 'wb') as f:
        for isbn in ISBN:
            f.write('%s\n' % isbn)


def write_overview_csv():
    with open('annotations.json', 'rb') as f:
        with open('books.csv', 'wb') as csvfile:
            bookwriter = csv.writer(csvfile)
            bookwriter.writerow(["text", "title"])
            annotations = json.loads(f.read())['objects']
            for annotation in annotations:
                bookwriter.writerow([annotation['annotation'].encode('utf-8', 'replace'), annotation['title']])
                print annotation['title']


def get_annotations():
    annotations = {}
    annotations['meta'] = {}
    annotations['meta']['count'] = 0
    annotations['objects'] = []

    with open('isbns.txt', 'r') as f:
        isbns = f.read()
        for isbn in isbns.split('\n'):
            details = {}

            ANNOTATION_DATA = {
                'key': isbn,
                'content': 'AnnotationDetail',
                'password': os.environ.get('BAKERTAYLOR_PASS', None),
                'userID': os.environ.get('BAKERTAYLOR_USER', None)
            }

            r = requests.post('http://contentcafe2.btol.com/contentcafe/contentcafe.asmx/Single', data=ANNOTATION_DATA)
            soup = BeautifulSoup(r.content)

            annotation_length = 0
            winning_annotation = None

            for annotation in soup.select('annotation'):
                if len(annotation.string) > annotation_length:
                    annotation_length = len(annotation.string)
                    winning_annotation = strip_html(annotation.string.encode('utf-8', 'replace'))

            if winning_annotation:

                DETAIL_DATA = {
                    'key': isbn,
                    'content': 'ProductDetail',
                    'password': os.environ.get('BAKERTAYLOR_PASS', None),
                    'userID': os.environ.get('BAKERTAYLOR_USER', None)
                }

                r = requests.post('http://contentcafe2.btol.com/contentcafe/contentcafe.asmx/Single', data=DETAIL_DATA)
                soup = BeautifulSoup(r.content)

                for key in ['title', 'pubdate', 'format', 'author', 'listprice', 'edition', 'isbn']:
                    try:
                        details[key] = soup.select(key)[0].string.encode('utf-8', 'replace')
                    except:
                        details[key] = None

                details['annotation'] = winning_annotation
                details['annotation_length'] = annotation_length

                annotations['objects'].append(details)
                print details

    annotations['meta']['count'] = len(annotations['objects'])

    with open('annotations.json', 'wb') as f:
        f.write(json.dumps(annotations))


def subject_url(search):
    return "http://openlibrary.org/search.json?subject=fiction %s" % search


def search_url(title):
    return 'http://openlibrary.org/api/search?q={"query":"(title:%s)"}' % title


def detail_url(openlibrary_id):
    return 'http://openlibrary.org/api/get?key=/books/%s' % openlibrary_id


def scrape_books():
    """
    Given an initial set of book titles, obtain all of the OpenLibrary IDs
    and detail URLs for them.
    Pasted into the BOOKS constant above. Because it takes time to generate and it isn't going to change much.
    """

    books_set = Set([])
    books_set.add(detail_url('OL16029951W'))

    with open('books.txt', 'rb') as all_books:
        for book in all_books.read().split('\n'):
            r = requests.get(search_url(book))
            content = json.loads(r.content)

            if content['status'] == 'ok':
                if content['result'] != []:
                    for openlibrary_id in content['result']:
                        openlibrary_id = openlibrary_id.split('/books/')[1]

                        books_set.add(detail_url(openlibrary_id))

                else:
                    print book, 'NONE'

            if content['status'] == 'error':
                print book, 'ERROR'

    return books_set


def scrape_categories():

    subject_frequency = defaultdict(int)

    for book in INITIAL_BOOKS:
        r = requests.get(book)
        try:
            content = json.loads(r.content)
        except ValueError:
            continue

        try:
            for subject in content['result']['subjects']:
                subject_frequency[subject.replace('.', '').encode('utf-8', 'replace')] += 1
                print subject

        except KeyError:
            pass

    sorted_list = []

    for item, count in subject_frequency.items():
        ignore = False

        for word in ignore_words:
            if word in item.lower():
                ignore = True

        if int(count) < 4:
            ignore = True

        if ignore is False:
            sorted_list.append({"name": item, "count": count})

    print len(sorted_list)

    with open('frequency.json', 'wb') as f:
        f.write(json.dumps(sorted(sorted_list, key=lambda item: item['count'], reverse=True)))
